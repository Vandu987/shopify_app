{%- assign rating = product.metafields.custom.rating.value | default: 0 -%}
{%- assign full_stars = rating | floor -%}
{%- assign half_star = 0 -%}

{%- if rating > full_stars -%}
  {%- assign half_star = 1 -%}
{%- endif -%}

{%- assign empty_stars = 5 | minus: full_stars | minus: half_star -%}

<div class="product-rating">
  {%- for i in (1..full_stars) -%}
    <svg class="star-icon" viewBox="0 0 24 24"><path fill="#FFD700" d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.998 1.504 8.313L12 18.896l-7.44 4.721 1.504-8.313-6.064-5.998 8.332-1.151z"/></svg>
  {%- endfor -%}

  {%- if half_star == 1 -%}
    <svg class="star-icon" viewBox="0 0 24 24">
      <defs>
        <linearGradient id="half-grad" x1="0" x2="1" y1="0" y2="0">
          <stop offset="50%" stop-color="#FFD700"/>
          <stop offset="50%" stop-color="#e0e0e0"/>
        </linearGradient>
      </defs>
      <path fill="url(#half-grad)" d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.998 1.504 8.313L12 18.896l-7.44 4.721 1.504-8.313-6.064-5.998 8.332-1.151z"/>
    </svg>
  {%- endif -%}

  {%- for i in (1..empty_stars) -%}
    <svg class="star-icon" viewBox="0 0 24 24"><path fill="#e0e0e0" d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.998 1.504 8.313L12 18.896l-7.44 4.721 1.504-8.313-6.064-5.998 8.332-1.151z"/></svg>
  {%- endfor -%}
</div>
